<!DOCTYPE html>
<html lang="de">
<head>
    <meta charset="UTF-8">
    <title>Security Event Dashboard</title>
    <meta name="viewport" content="width=device-width, initial-scale=1.0">

    <!-- Styles -->
    <link rel="stylesheet" href="src/css/styles.css">

    <!-- External Libraries -->
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
    <!-- jsPDF (UMD) -->
    <script src="https://cdnjs.cloudflare.com/ajax/libs/jspdf/2.5.1/jspdf.umd.min.js"></script>
    <!-- jsPDF AutoTable fÃ¼r Tabellen im PDF -->
    <script src="https://cdnjs.cloudflare.com/ajax/libs/jspdf-autotable/3.8.2/jspdf.plugin.autotable.min.js"></script>
    <!-- html2canvas (optional) -->
    <script src="https://cdnjs.cloudflare.com/ajax/libs/html2canvas/1.4.1/html2canvas.min.js"></script>
</head>
<body>
<div class="app-shell">
    <!-- ========== SIDEBAR ========== -->
    <aside class="sidebar">
        <div class="sidebar-header">
            <div class="brand">SECURITY<span>DASH</span></div>
            <div class="subtitle">Security Events Management Dashboard</div>
        </div>

        <!-- Data Source Section -->
        <div class="sidebar-section">
            <div class="sidebar-section-title">Datenquelle</div>
            <div class="file-input-wrapper">
                <label>
                    CSV-Datei fÃ¼r Ereignismeldungen auswÃ¤hlen
                    <input type="file" id="fileInput" accept=".csv">
                </label>
                <div class="hint">
                    Erwartete Spalten z.B.: <strong>Land, Liegenschaft, Ereignisart, Datum</strong>
                </div>
                <div id="fileStatus" class="status">Keine Datei geladen.</div>
            </div>
            <button class="btn outline-light" id="loadTestData">Testdaten laden (Demo-Modus)</button>
        </div>

        <!-- Filter Section -->
        <div class="sidebar-section">
            <div class="sidebar-section-title">Filter</div>
            <div class="filters">
                <div class="filter-row">
                    <label for="filterCountry">Land</label>
                    <select id="filterCountry">
                        <option value="__ALL__">Alle LÃ¤nder</option>
                    </select>
                </div>
                <div class="filter-row">
                    <label for="filterSite">Liegenschaft</label>
                    <select id="filterSite">
                        <option value="__ALL__">Alle Liegenschaften</option>
                    </select>
                </div>
                <div class="filter-row">
                    <label for="filterType">Ereignisart</label>
                    <select id="filterType">
                        <option value="__ALL__">Alle Ereignisarten</option>
                    </select>
                </div>
                <button class="btn secondary" id="resetFilters">Filter zurÃ¼cksetzen</button>
                <div id="filterStatus" class="status"></div>
            </div>
        </div>

        <!-- Export Section -->
        <div class="sidebar-section">
            <div class="sidebar-section-title">Export</div>
            <button class="btn secondary" id="exportCSV">ğŸ“„ CSV exportieren</button>
            <button class="btn primary" id="exportPDF">ğŸ“Š PDF Report erstellen</button>
            <div id="exportStatus" class="status" style="display: none;"></div>
        </div>
    </aside>

    <!-- ========== MAIN CONTENT ========== -->
    <main class="main">
        <!-- Theme Toggle -->
        <div class="theme-toggle-wrapper">
            <button id="themeToggle" class="theme-toggle" title="Dark/Light Mode umschalten">
                <span class="theme-icon sun">â˜€ï¸</span>
                <span class="theme-icon moon">ğŸŒ™</span>
                <div class="theme-toggle-slider"></div>
            </button>
            <span class="theme-label">Dark Mode</span>
        </div>

        <!-- Header -->
        <header class="main-header">
            <div>
                <h1>Security Events Overview</h1>
                <h3>Echtzeit-Ãœbersicht Ã¼ber gemeldete Ereignisse nach Land, Liegenschaft und Ereignisart</h3>
            </div>
            <div class="main-header-right">
                <div class="pill">
                    <span id="recordCount">0</span> DatensÃ¤tze geladen
                </div>
                <div class="pill secondary" id="modeIndicator">Modus: Keine Daten</div>
            </div>
        </header>

        <!-- KPI Cards -->
        <section class="card-grid" aria-label="Kennzahlen">
            <div class="card">
                <div class="card-title">Gesamtzahl Ereignisse</div>
                <div class="card-value" id="kpiTotalEvents">0</div>
                <div class="card-subvalue" id="kpiTotalEventsSub">0 nach Filter</div>
            </div>
            <div class="card">
                <div class="card-title">LÃ¤nder</div>
                <div class="card-value" id="kpiCountries">0</div>
                <div class="card-subvalue">Distinct nach Feld â€Land"</div>
            </div>
            <div class="card">
                <div class="card-title">Liegenschaften</div>
                <div class="card-value" id="kpiSites">0</div>
                <div class="card-subvalue">Distinct nach Feld â€Liegenschaft"</div>
            </div>
            <div class="card">
                <div class="card-title">Ereignisarten</div>
                <div class="card-value" id="kpiTypes">0</div>
                <div class="card-subvalue">Distinct nach Feld â€Ereignisart"</div>
            </div>
        </section>

        <!-- Smart Analytics Panel -->
        <section class="analytics-panel">
            <div class="panel-header">
                <div>
                    <div class="panel-title">ğŸ§  Smart Analytics & Insights</div>
                    <div class="panel-subtitle">
                        KI-basierte Muster-Erkennung und automatische Sicherheitsanalyse
                    </div>
                </div>
            </div>
            <div class="insights-grid">
                <div class="insight-card">
                    <div class="insight-header">
                        <span class="insight-icon">âš ï¸</span>
                        <h4>Risiko-Assessment</h4>
                    </div>
                    <div id="riskAssessment" class="insight-content">
                        <div class="loading">Analysiere Risiko-Muster...</div>
                    </div>
                </div>
                <div class="insight-card">
                    <div class="insight-header">
                        <span class="insight-icon">ğŸ”</span>
                        <h4>Muster-Erkennung</h4>
                    </div>
                    <div id="patternDetection" class="insight-content">
                        <div class="loading">Suche nach Anomalien...</div>
                    </div>
                </div>
                <div class="insight-card">
                    <div class="insight-header">
                        <span class="insight-icon">ğŸ’¡</span>
                        <h4>Empfehlungen</h4>
                    </div>
                    <div id="smartRecommendations" class="insight-content">
                        <div class="loading">Generiere Handlungsempfehlungen...</div>
                    </div>
                </div>
                <div class="insight-card">
                    <div class="insight-header">
                        <span class="insight-icon">ğŸ“ˆ</span>
                        <h4>Trend-Prognose</h4>
                    </div>
                    <div id="trendForecast" class="insight-content">
                        <div class="loading">Berechne Zukunftstrends...</div>
                    </div>
                </div>
            </div>
        </section>

        <!-- Content Grid -->
        <section class="content-grid">
            <!-- Tables Panel -->
            <section class="panel" aria-label="Tabellarische Auswertung">
                <div class="panel-header">
                    <div>
                        <div class="panel-title">Aggregierte Ãœbersicht</div>
                        <div class="panel-subtitle">
                            HÃ¤ufigkeiten nach Land, Liegenschaft und Ereignisart
                        </div>
                    </div>
                </div>

                <h3>Nach Land</h3>
                <div class="table-wrapper">
                    <table id="tableByCountry">
                        <thead>
                        <tr>
                            <th>Land</th>
                            <th>Anzahl Ereignisse</th>
                        </tr>
                        </thead>
                        <tbody></tbody>
                    </table>
                </div>

                <h3>Nach Liegenschaft</h3>
                <div class="table-wrapper">
                    <table id="tableBySite">
                        <thead>
                        <tr>
                            <th>Liegenschaft</th>
                            <th>Land</th>
                            <th>Anzahl Ereignisse</th>
                        </tr>
                        </thead>
                        <tbody></tbody>
                    </table>
                </div>

                <h3>Nach Ereignisart</h3>
                <div class="table-wrapper">
                    <table id="tableByType">
                        <thead>
                        <tr>
                            <th>Ereignisart</th>
                            <th>Anzahl Ereignisse</th>
                        </tr>
                        </thead>
                        <tbody></tbody>
                    </table>
                </div>
            </section>

            <!-- Charts Panel -->
            <section class="panel" aria-label="Visualisierung">
                <div class="panel-header">
                    <div>
                        <div class="panel-title">Visualisierung & Benchmark</div>
                        <div class="panel-subtitle">
                            Top-LÃ¤nder, Liegenschaften und Ereignisarten nach HÃ¤ufigkeit
                        </div>
                    </div>
                </div>

                <h3>Top LÃ¤nder (nach EreignishÃ¤ufigkeit)</h3>
                <div id="chartCountries" class="chart"></div>

                <h3>Top Liegenschaften</h3>
                <div id="chartSites" class="chart"></div>

                <h3>Top Ereignisarten</h3>
                <div id="chartTypes" class="chart"></div>
            </section>
        </section>
    </main>
</div>

<!-- Haupt-JavaScript -->
<script src="src/js/app.js"></script>
</body>
</html>
