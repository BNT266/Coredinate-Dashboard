<!DOCTYPE html>
<html lang="de">
<head>
    <meta charset="UTF-8" />
    <title>Security Event Dashboard</title>
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    
    <!-- External CSS -->
    <link rel="stylesheet" href="src/css/styles.css">
    
    <!-- Chart.js Library -->
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
</head>
    
</head>
<body>
<div class="app-shell">
    <!-- ========== SIDEBAR ========== -->
    <aside class="sidebar">
        <div class="sidebar-header">
            <div class="brand">SECURITY<span>DASH</span></div>
            <div class="subtitle">Security Events Management Dashboard</div>
        </div>

        <!-- CSV Upload & Testmodus -->
        <div class="sidebar-section">
            <div class="sidebar-section-title">Datenquelle</div>

            <div class="file-input-wrapper">
                <label>
                    CSV-Datei für Ereignismeldungen auswählen
                    <input type="file" id="fileInput" accept=".csv" />
                </label>
                <div class="hint">
                    Erwartete Spalten z.B.: <strong>Land, Liegenschaft, Ereignisart, Datum</strong>
                </div>
                <div id="fileStatus" class="status">Keine Datei geladen.</div>
            </div>

            <button class="btn outline-light" id="loadTestData">
                Testdaten laden (Demo-Modus)
            </button>
            <div class="hint">
                Nutze den Testmodus, um das Dashboard ohne eigene CSV-Datei auszuprobieren.
            </div>
        </div>

        <!-- Filter -->
        <div class="sidebar-section">
            <div class="sidebar-section-title">Filter</div>
            <div class="filters">
                <div class="filter-row">
                    <label for="filterCountry">Land</label>
                    <select id="filterCountry">
                        <option value="__ALL__">Alle Länder</option>
                    </select>
                </div>
                <div class="filter-row">
                    <label for="filterSite">Liegenschaft</label>
                    <select id="filterSite">
                        <option value="__ALL__">Alle Liegenschaften</option>
                    </select>
                </div>
                <div class="filter-row">
                    <label for="filterType">Ereignisart</label>
                    <select id="filterType">
                        <option value="__ALL__">Alle Ereignisarten</option>
                    </select>
                </div>
                <button class="btn secondary" id="resetFilters">Filter zurücksetzen</button>
                <div id="filterStatus" class="status"></div>
            </div>
        </div>
    </aside>

    <!-- ========== MAIN CONTENT ========== -->
    <main class="main">
        <!-- Header -->
        <header class="main-header">
            <div>
                <h1>Security Events Overview</h1>
                <h3>Echtzeit-Übersicht über gemeldete Ereignisse nach Land, Liegenschaft und Ereignisart</h3>
            </div>
            <div class="main-header-right">
                <div class="pill">
                    <span id="recordCount">0</span> Datensätze geladen
                </div>
                <div class="pill secondary" id="modeIndicator">
                    Modus: Keine Daten
                </div>
            </div>
        </header>

        <!-- KPI Cards -->
        <section class="card-grid" aria-label="Kennzahlen">
            <div class="card">
                <div class="card-title">Gesamtzahl Ereignisse</div>
                <div class="card-value" id="kpiTotalEvents">0</div>
                <div class="card-subvalue" id="kpiTotalEventsSub">0 nach Filter</div>
            </div>
            <div class="card">
                <div class="card-title">Länder</div>
                <div class="card-value" id="kpiCountries">0</div>
                <div class="card-subvalue">Distinct nach Feld „Land"</div>
            </div>
            <div class="card">
                <div class="card-title">Liegenschaften</div>
                <div class="card-value" id="kpiSites">0</div>
                <div class="card-subvalue">Distinct nach Feld „Liegenschaft"</div>
            </div>
            <div class="card">
                <div class="card-title">Ereignisarten</div>
                <div class="card-value" id="kpiTypes">0</div>
                <div class="card-subvalue">Distinct nach Feld „Ereignisart"</div>
            </div>
        </section>

        <!-- Grids -->
        <section class="content-grid">
            <!-- Left: Tables -->
            <section class="panel" aria-label="Tabellarische Auswertung">
                <div class="panel-header">
                    <div>
                        <div class="panel-title">Aggregierte Übersicht</div>
                        <div class="panel-subtitle">
                            Häufigkeiten nach Land, Liegenschaft und Ereignisart (inkl. aktiver Filter)
                        </div>
                    </div>
                </div>

                <h3>Nach Land</h3>
                <div class="table-wrapper">
                    <table id="tableByCountry">
                        <thead>
                        <tr>
                            <th>Land</th>
                            <th>Anzahl Ereignisse</th>
                        </tr>
                        </thead>
                        <tbody></tbody>
                    </table>
                </div>

                <h3>Nach Liegenschaft</h3>
                <div class="table-wrapper">
                    <table id="tableBySite">
                        <thead>
                        <tr>
                            <th>Liegenschaft</th>
                            <th>Land</th>
                            <th>Anzahl Ereignisse</th>
                        </tr>
                        </thead>
                        <tbody></tbody>
                    </table>
                </div>

                <h3>Nach Ereignisart</h3>
                <div class="table-wrapper">
                    <table id="tableByType">
                        <thead>
                        <tr>
                            <th>Ereignisart</th>
                            <th>Anzahl Ereignisse</th>
                        </tr>
                        </thead>
                        <tbody></tbody>
                    </table>
                </div>
            </section>

            <!-- Right: Charts & Benchmarks -->
            <section class="panel" aria-label="Visualisierung">
                <div class="panel-header">
                    <div>
                        <div class="panel-title">Visualisierung & Benchmark</div>
                        <div class="panel-subtitle">
                            Top-Länder, Liegenschaften und Ereignisarten nach Häufigkeit
                        </div>
                    </div>
                </div>

                <h3>Top Länder (nach Ereignishäufigkeit)</h3>
                <div id="chartCountries" class="chart"></div>

                <h3>Top Liegenschaften</h3>
                <div id="chartSites" class="chart"></div>

                <h3>Top Ereignisarten</h3>
                <div id="chartTypes" class="chart"></div>
            </section>
        </section>
    </main>
</div>

<!-- ES6 Module JavaScript -->
<script type="module">
document.addEventListener('DOMContentLoaded', function() {
    // Import und starte main.js als ES6 Module
    import('./src/js/main.js')
        .then(() => {
            console.log('Dashboard modules loaded successfully');
        })
        .catch(err => {
            console.error('Error loading dashboard modules:', err);
        });
});
</script>
</body>
</html>
