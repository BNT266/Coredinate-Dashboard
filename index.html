<!DOCTYPE html>
<html lang="de">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta name="description" content="Security Event Dashboard zur √úberwachung und Analyse von Sicherheitsereignissen">
    <title>Security Event Dashboard</title>

    <!-- Styles -->
    <link rel="stylesheet" href="src/css/styles.css">
</head>
<body>
<div class="app-shell">
    <!-- ========== SIDEBAR ========== -->
    <aside class="sidebar">
        <div class="sidebar-header">
            <div class="brand">SECURITY<span>DASH</span></div>
            <div class="subtitle">Security Events Management Dashboard</div>
        </div>

        <!-- Data Source Section -->
        <div class="sidebar-section">
            <div class="sidebar-section-title">Datenquelle</div>
            <div class="file-input-wrapper">
                <label for="fileInput">
                    CSV-Datei f√ºr Ereignismeldungen ausw√§hlen
                    <input type="file" id="fileInput" accept=".csv">
                </label>
            </div>
            <div class="hint">
                Erwartete Spalten z.B.: <strong>Land, Liegenschaft, Ereignisart, Datum</strong>
            </div>
            <div id="fileStatus" class="status">Keine Datei geladen.</div>
            <button type="button" class="btn outline-light" id="loadTestData">
                Testdaten laden (Demo-Modus)
            </button>
        </div>

        <!-- Filter Section -->
        <div class="sidebar-section">
            <div class="sidebar-section-title">Filter</div>
            <div class="filters">
                <div class="filter-row">
                    <label for="filterCountry">Land</label>
                    <select id="filterCountry">
                        <option value="__ALL__">Alle L√§nder</option>
                    </select>
                </div>
                <div class="filter-row">
                    <label for="filterSite">Liegenschaft</label>
                    <select id="filterSite">
                        <option value="__ALL__">Alle Liegenschaften</option>
                    </select>
                </div>
                <div class="filter-row">
                    <label for="filterType">Ereignisart</label>
                    <select id="filterType">
                        <option value="__ALL__">Alle Ereignisarten</option>
                    </select>
                </div>
                <button type="button" class="btn secondary" id="resetFilters">
                    Filter zur√ºcksetzen
                </button>
                <div id="filterStatus" class="status"></div>
            </div>
        </div>

        <!-- Export Section -->
        <div class="sidebar-section">
            <div class="sidebar-section-title">Export</div>
            <button type="button" class="btn secondary" id="exportCSV">
                <span aria-hidden="true">üìÑ</span> CSV exportieren
            </button>
            <button type="button" class="btn primary" id="exportPDF">
                <span aria-hidden="true">üìä</span> Executive PDF-Report erstellen
            </button>
            <div id="exportStatus" class="status" style="display: none;"></div>
        </div>

        <!-- Risk Config Section -->
        <div class="sidebar-section">
            <div class="sidebar-section-title">Risiko-Konfiguration</div>
            <div id="riskConfigContainer" class="risk-config"></div>
        </div>
    </aside>

    <!-- ========== MAIN CONTENT ========== -->
    <main class="main">
        <!-- Top Bar: Theme + Sprache -->
        <div class="top-bar">
            <!-- Theme Toggle -->
            <div class="theme-toggle-wrapper">
                <button type="button" id="themeToggle" class="theme-toggle" 
                        title="Dark/Light Mode umschalten"
                        aria-label="Theme umschalten">
                    <span class="theme-icon sun" aria-hidden="true">‚òÄÔ∏è</span>
                    <span class="theme-icon moon" aria-hidden="true">üåô</span>
                    <div class="theme-toggle-slider"></div>
                </button>
                <span class="theme-label">Dark Mode</span>
            </div>

            <!-- Report-Sprache -->
            <div class="language-select-wrapper">
                <label for="reportLanguage">Report-Sprache:</label>
                <select id="reportLanguage">
                    <option value="de" selected>Deutsch</option>
                    <option value="en">English</option>
                </select>
            </div>
        </div>

        <!-- Header -->
        <header class="main-header">
            <div>
                <h1>Security Events Overview</h1>
                <p class="main-header-subtitle">
                    Echtzeit-√úbersicht √ºber gemeldete Ereignisse nach Land, Liegenschaft und Ereignisart
                </p>
            </div>
            <div class="main-header-right">
                <div class="pill">
                    <span id="recordCount">0</span> Datens√§tze geladen
                </div>
                <div class="pill secondary" id="modeIndicator">Modus: Keine Daten</div>
            </div>
        </header>

        <!-- KPI Cards -->
        <section class="card-grid" aria-label="Kennzahlen">
            <article class="card">
                <div class="card-title">Gesamtzahl Ereignisse</div>
                <div class="card-value" id="kpiTotalEvents">0</div>
                <div class="card-subvalue" id="kpiTotalEventsSub">0 nach Filter</div>
            </article>
            <article class="card">
                <div class="card-title">L√§nder</div>
                <div class="card-value" id="kpiCountries">0</div>
                <div class="card-subvalue">Distinct nach Feld ‚ÄûLand"</div>
            </article>
            <article class="card">
                <div class="card-title">Liegenschaften</div>
                <div class="card-value" id="kpiSites">0</div>
                <div class="card-subvalue">Distinct nach Feld ‚ÄûLiegenschaft"</div>
            </article>
            <article class="card">
                <div class="card-title">Ereignisarten</div>
                <div class="card-value" id="kpiTypes">0</div>
                <div class="card-subvalue">Distinct nach Feld ‚ÄûEreignisart"</div>
            </article>
        </section>

        <!-- Smart Analytics Panel -->
        <section class="analytics-panel" aria-label="Smart Analytics">
            <div class="panel-header">
                <div>
                    <h2 class="panel-title">
                        <span aria-hidden="true">üß†</span> Smart Analytics &amp; Insights
                    </h2>
                    <p class="panel-subtitle">
                        KI-basierte Muster-Erkennung und automatische Sicherheitsanalyse
                    </p>
                </div>
            </div>
            <div class="insights-grid">
                <article class="insight-card">
                    <div class="insight-header">
                        <span class="insight-icon" aria-hidden="true">‚ö†Ô∏è</span>
                        <h3>Risiko-Assessment</h3>
                    </div>
                    <div id="riskAssessment" class="insight-content">
                        <div class="loading">Analysiere Risiko-Muster...</div>
                    </div>
                </article>
                <article class="insight-card">
                    <div class="insight-header">
                        <span class="insight-icon" aria-hidden="true">üîç</span>
                        <h3>Muster-Erkennung</h3>
                    </div>
                    <div id="patternDetection" class="insight-content">
                        <div class="loading">Suche nach Anomalien...</div>
                    </div>
                </article>
                <article class="insight-card">
                    <div class="insight-header">
                        <span class="insight-icon" aria-hidden="true">üí°</span>
                        <h3>Empfehlungen</h3>
                    </div>
                    <div id="smartRecommendations" class="insight-content">
                        <div class="loading">Generiere Handlungsempfehlungen...</div>
                    </div>
                </article>
                <article class="insight-card">
                    <div class="insight-header">
                        <span class="insight-icon" aria-hidden="true">üìà</span>
                        <h3>Trend-Prognose</h3>
                    </div>
                    <div id="trendForecast" class="insight-content">
                        <div class="loading">Berechne Zukunftstrends...</div>
                    </div>
                </article>
            </div>
        </section>

        <!-- Content Grid -->
        <div class="content-grid">
            <!-- Tables Panel -->
            <section class="panel" aria-label="Tabellarische Auswertung">
                <div class="panel-header">
                    <div>
                        <h2 class="panel-title">Aggregierte √úbersicht</h2>
                        <p class="panel-subtitle">
                            H√§ufigkeiten nach Land, Liegenschaft und Ereignisart
                        </p>
                    </div>
                </div>

                <h3>Nach Land</h3>
                <div class="table-wrapper">
                    <table id="tableByCountry">
                        <thead>
                        <tr>
                            <th scope="col">Land</th>
                            <th scope="col">Anzahl Ereignisse</th>
                        </tr>
                        </thead>
                        <tbody></tbody>
                    </table>
                </div>

                <h3>Nach Liegenschaft</h3>
                <div class="table-wrapper">
                    <table id="tableBySite">
                        <thead>
                        <tr>
                            <th scope="col">Liegenschaft</th>
                            <th scope="col">Land</th>
                            <th scope="col">Anzahl Ereignisse</th>
                        </tr>
                        </thead>
                        <tbody></tbody>
                    </table>
                </div>

                <h3>Nach Ereignisart</h3>
                <div class="table-wrapper">
                    <table id="tableByType">
                        <thead>
                        <tr>
                            <th scope="col">Ereignisart</th>
                            <th scope="col">Anzahl Ereignisse</th>
                        </tr>
                        </thead>
                        <tbody></tbody>
                    </table>
                </div>
            </section>

            <!-- Charts Panel -->
            <section class="panel" aria-label="Visualisierung">
                <div class="panel-header">
                    <div>
                        <h2 class="panel-title">Visualisierung &amp; Benchmark</h2>
                        <p class="panel-subtitle">
                            Top-L√§nder, Liegenschaften und Ereignisarten nach H√§ufigkeit
                        </p>
                    </div>
                </div>

                <h3>Top L√§nder (nach Ereignish√§ufigkeit)</h3>
                <div id="chartCountries" class="chart" role="img" aria-label="Balkendiagramm Ereignisse nach L√§ndern"></div>

                <h3>Top Liegenschaften</h3>
                <div id="chartSites" class="chart" role="img" aria-label="Balkendiagramm Ereignisse nach Liegenschaften"></div>

                <h3>Top Ereignisarten</h3>
                <div id="chartTypes" class="chart" role="img" aria-label="Kreisdiagramm Ereignisse nach Typ"></div>

                <h3>Bereichsverteilung (Security / FM / SHE)</h3>
                <div id="chartDomains" class="chart" role="img" aria-label="Kreisdiagramm Bereichsverteilung"></div>
            </section>
        </div>
    </main>
</div>

<!-- Toast-Container f√ºr Systemmeldungen -->
<div id="toastContainer" class="toast-container" role="alert" aria-live="polite"></div>

<!-- ============================================= -->
<!-- WICHTIG: Scripts am Ende, in korrekter Reihenfolge! -->
<!-- ============================================= -->
<script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/jspdf/2.5.1/jspdf.umd.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/jspdf-autotable/3.8.2/jspdf.plugin.autotable.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/html2canvas/1.4.1/html2canvas.min.js"></script>
<script src="src/js/app.js"></script>
</body>
</html>
